<!DOCTYPE html>
<html>
<head>
    <title>Items in <%= categoryName %></title>
    <style>
        /* Pop-up styling */
        #popup {
            display: none;
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: #28a745; /* Green for success */
            color: white;
            padding: 10px 20px;
            border-radius: 5px;
            box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.2);
            z-index: 1000;
        }
    </style>
    <script>
        function showPopup(message, isError = false) {
            const popup = document.getElementById('popup');
            popup.innerText = message;
            popup.style.background = isError ? "#dc3545" : "#28a745"; // Red for error, green for success
            popup.style.display = 'block';

            setTimeout(() => {
                popup.style.display = 'none';
            }, 2000); // Hide pop-up after 2 seconds
        }

        // Check if there's a message in the URL and show the pop-up
        document.addEventListener("DOMContentLoaded", function () {
            const urlParams = new URLSearchParams(window.location.search);
            const message = urlParams.get('message');
            const isError = urlParams.get('error') === "true";

            if (message) {
                showPopup(message, isError);
                // Remove the message from URL without reloading
                window.history.replaceState(null, null, window.location.pathname);
            }
        });

        function confirmDelete(itemId, categoryId) {
            if (confirm("Are you sure you want to remove this item?")) {
                window.location.href = `/items/${itemId}/delete`;
            }
        }
    </script>
</head>
<body>
    <!-- Pop-up Notification -->
    <div id="popup"></div>

    <h1>Items in <%= categoryName %></h1>

    <% if (items.length > 0) { %>
        <ul>
            <% items.forEach(item => { %>
                <li>
                    <strong><%= item.name %></strong> - <%= item.description %> 
                    (Qty: <%= item.quantity %>, Price: $<%= item.price %>)
                    <button onclick="confirmDelete('<%= item.id %>', '<%= categoryId %>')">Delete</button>
                </li>
            <% }) %>
        </ul>
    <% } else { %>
        <p>No items available in this category.</p>
    <% } %>

    <h2>Add a New Item</h2>
    <form action="/items" method="POST">
        <input type="hidden" name="category_id" value="<%= categoryId %>">
        <label>Name: <input type="text" name="name" required></label><br>
        <label>Description: <input type="text" name="description" required></label><br>
        <label>Quantity: <input type="number" name="quantity" required></label><br>
        <label>Price: <input type="number" step="0.01" name="price" required></label><br>
        <button type="submit">Add Item</button>
    </form>

    <a href="/">Back to Categories</a>
</body>
</html>


